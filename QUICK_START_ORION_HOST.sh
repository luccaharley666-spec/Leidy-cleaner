#!/bin/bash

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# QUICK START - ORION HOST EM 5 PASSOS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# 
# Execute cada bloco em sequรชncia no seu servidor Orion Host
# 
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ     ๐ QUICK START - ORION HOST EM 5 PASSOS ๐         โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PASSO 1: VARIรVEIS DE CONFIGURAรรO
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo "โ๏ธ  PASSO 1: CONFIGURAR VARIรVEIS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "Edite as variรกveis abaixo e execute:"
echo ""

# EDITAR AQUI โโโ
DOMAIN="seu-dominio.com.br"
EMAIL="admin@seu-dominio.com.br"
PROJECT_DIR="${HOME}/meu-site"
# EDITAR AQUI โโโ

echo "DOMAIN=$DOMAIN"
echo "EMAIL=$EMAIL"
echo "PROJECT_DIR=$PROJECT_DIR"
echo ""
echo "โ Se os valores estรฃo corretos, prossiga para PASSO 2"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PASSO 2: CLONAR E PREPARAR
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "๐ PASSO 2: CLONAR REPOSITรRIO"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "Copie e execute em seu servidor:"
echo ""
cat << BASH1

# Clone o projeto
cd ~
git clone https://github.com/seu-usuario/seu-repo.git meu-site
cd meu-site

BASH1

echo "โ Execute o comando acima, depois volte aqui"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PASSO 3: DEPLOY AUTOMรTICO
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "๐ PASSO 3: EXECUTAR DEPLOY AUTOMรTICO"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "Copie e execute em seu servidor:"
echo ""
cat << BASH2

bash deploy-orionhost-automated.sh ${DOMAIN} ${EMAIL}

BASH2

echo "โ O script cuidarรก de tudo!"
echo "   Responda 's' quando solicitado"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PASSO 4: ATUALIZAR CREDENCIAIS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "๐ PASSO 4: ADICIONAR CREDENCIAIS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "Copie e execute em seu servidor:"
echo ""
cat << BASH3

nano .env.production

BASH3

echo ""
echo "Procure e preencha APENAS se tiver as credenciais:"
echo ""
cat << CREDS

# DEIXAR EM BRANCO INICIALMENTE:
SMTP_HOST=mail.seu-dominio.com.br
SMTP_USER=seu-email@seu-dominio.com.br
SMTP_PASS=sua-senha-app

# DEIXAR EM BRANCO (opcional):
STRIPE_PUBLIC_KEY=pk_live_...
STRIPE_SECRET_KEY=sk_live_...

CREDS

echo ""
echo "Salve com: Ctrl+O โ Enter โ Ctrl+X"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# PASSO 5: INICIAR SERVIรOS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "โถ๏ธ  PASSO 5: INICIAR SERVIรOS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "Copie e execute em seu servidor (com sudo):"
echo ""
cat << BASH4

sudo systemctl start ${DOMAIN}-backend.service
sudo systemctl start ${DOMAIN}-frontend.service

# Verificar status
sudo systemctl status ${DOMAIN}-backend.service
sudo systemctl status ${DOMAIN}-frontend.service

BASH4

echo ""
echo "โ Se ambos mostram 'active (running)', estรก funcionando!"
echo ""

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# TESTES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

echo ""
echo "๐งช TESTES RรPIDOS"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "1๏ธโฃ  TESTAR API (no servidor):"
cat << BASH5

curl -I https://api.${DOMAIN}/api/health
# Esperado: HTTP/2 200

BASH5

echo ""
echo "2๏ธโฃ  ABRIR NO NAVEGADOR (seu computador):"
cat << BASH6

https://${DOMAIN}
https://api.${DOMAIN}/api/health

BASH6

echo ""
echo ""
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "๐ PRONTO!"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""
echo "Seu site estรก em: https://${DOMAIN}"
echo "API estรก em:     https://api.${DOMAIN}"
echo ""
echo "๐ Documentaรงรฃo completa:"
echo "   DEPLOY_ORION_HOST_COMPLETO.md"
echo "   ORION_HOST_RESUMO_RAPIDO.md"
echo ""
echo "โ Problemas?"
echo "   Ver logs: sudo journalctl -u ${DOMAIN}* -f"
echo ""
